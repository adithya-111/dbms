 CREATE TABLE PUBLISHER
 ( NAME VARCHAR(20)PRIMARY KEY,
   ADDRESS VARCHAR(20),
   PHONE NUMBER(10));

INSERT INTO PUBLISHER
VALUES ('AUISHKAR','INDIA','99912112');

 CREATE TABLE BOOK
 ( BOOKID INT PRIMARY KEY,
   TITLE VARCHAR2(40),
   PUBLISHER VARCHAR2(40) REFERENCES PUBLISHER ON DELETE CASCADE,
   PUB_YEAR INT);

INSERT INTO BOOK
VALUES('5','HALF GIRLFRIEND','ROOPAND CO',2014);


 CREATE TABLE LIBRARY_BRANCH
 ( BRANCH_ID INT PRIMARY KEY,
   BRANCH_NAME VARCHAR(20),
   ADDRESS VARCHAR(20));

 INSERT INTO LIBRARY_BRANCH
 VALUES ('5','KS RAO ROAD','CHENNAI');

 CREATE TABLE BOOK_COPIES
 ( 
   BOOK_ID NUMBER(2) REFERENCES BOOK ON DELETE CASCADE,
   BRANCH_ID NUMBER(2) REFERENCES LIBRARY_BRANCH ON DELETE CASCADE,
   NO_OF_COPIES NUMBER(2), 
   PRIMARY KEY(BOOK_ID,BRANCH_ID)
);

 INSERT INTO BOOK_COPIES
 VALUES ('4','2','10');


CREATE TABLE BOOK_LENDING
( 
  BOOK_ID NUMBER(5),
  BRANCH_ID NUMBER(5),
  CARD_NO NUMBER(5),
  DATE_OUT DATE,
  DUE_DATE DATE,
  FOREIGN KEY(BOOK_ID,BRANCH_ID) REFERENCES BOOK_COPIES ON DELETE CASCADE,
  PRIMARY KEY(BRANCH_ID,BOOK_ID,CARD_NO),
  CONSTRAINT CK1 CHECK(DUE_DATE> DATE_OUT)
);

 INSERT INTO BOOK_LENDING
 VALUES('1','1','2','02-JUN-2017','09-JUL-2017');

CREATE TABLE BOOK_AUTHORS
( 
  BOOK_ID INT REFERENCES BOOK ON DELETE CASCADE,
  AUTHOR_NAME VARCHAR(20),
  PRIMARY KEY(BOOK_ID,AUTHOR_NAME)
);
 

INSERT INTO BOOK_AUTHORS
VALUES('5','VIKAS');

Q1
SELECT B.BOOKID,B.TITLE,B.PUBLISHER,A.AUTHOR_NAME,L.BRANCH_NAME,C.NO_OF_COPIES
FROM BOOK B,BOOK_AUTHORS A,BOOK_COPIES C,LIBRARY_BRANCH L
WHERE B.BOOKID = A.BOOK_ID 
      AND A.BOOK_ID = C.BOOK_ID 
      AND C.BRANCH_ID = L.BRANCH_ID ;

Q2
SELECT CARD_NO AS CARD_NUM
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '01-JAN-17' AND '30-JUN-17'
GROUP BY CARD_NO
HAVING COUNT(BOOK_ID)>3;

Q3
DELETE
FROM BOOK
WHERE BOOKID=2

Q4
CREATE TABLE BOOKP
(
	BOOK_ID INT NOT NULL,
	TITLE VARCHAR(20),
	PUBLISHER_NAME VARCHAR(20),
	PUB_YEAR INT
)
PARTITION BY RANGE(PUB_YEAR)
(
	PARTITION Q0 VALUES LESS THAN(2002),
	PARTITION Q1 VALUES LESS THAN(2010),
	PARTITION Q2 VALUES LESS THAN(2015)
);


q5
CREATE VIEW BOOK_COPIES_VIEW AS 
SELECT B.TITLE,C.BRANCH_ID,C.NO_OF_COPIES
FROM BOOK B,BOOK_COPIES C
WHERE B.BOOKID=C.BOOK_ID;
